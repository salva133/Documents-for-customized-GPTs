﻿sg_expand_basic_building = {
	category = sgcat_tutorial

	trigger = {
		any_scope_building = {
			is_under_construction = no
			is_farm_building = yes
			can_queue_building_levels = 1
		}
	}
	
	on_start = {
		start_tutorial_lesson = { tutorial_lesson = lesson_journal }
		
		if = {
			limit = {
				market_capital = {
					owner = ROOT
				}
			}
			save_scope_as = tutorial_state_target	
		}
		else = {
			capital = {
				save_scope_as = tutorial_state_target
			}
		}

		if = {
			limit = {
				scope:tutorial_state_target = {
					any_scope_building = {
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}					
				}
			}
			scope:tutorial_state_target = {
				random_scope_building = {
					limit = {	
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}
					save_scope_as = tutorial_building_target

				}			
			}
		}
		else_if = {
			limit = {
				any_scope_state = {
					is_incorporated = yes
					any_scope_building = {
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}					
				}				
			}
			
			random_scope_state = {
				limit = { 
					is_incorporated = yes
					any_scope_building = {
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}
				}
				
				random_scope_building = {
					limit = {	
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}
					save_scope_as = tutorial_building_target
				}						
			}			
		}
		else = {
			random_scope_building = {
				limit = {	
					is_under_construction = no
					is_farm_building = yes
					can_queue_building_levels = 1
				}
				save_scope_as = tutorial_building_target
			}	
		}

		add_journal_entry = {
			type = je_tutorial_expand_basic_building
			objective_subgoal = sg_expand_basic_building
			target = scope:tutorial_building_target
		}			
	}
}

# Fix Budget Deficit
sg_fix_budget_deficit = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expand_productive_building
	}

	trigger = {
		gold_reserves = 0
		weekly_net_fixed_income <= -1000 # Do not trigger this based on a tiny deficit that will self-correct
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_fix_budget_deficit
			objective_subgoal = sg_fix_budget_deficit
		}	
	}
}

# Change Production Method
sg_change_production_method = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_expand_basic_building
	}

	trigger = {
		any_scope_state = {
			OR = {
				AND = {
					can_activate_production_method = {
						building_type = building_rye_farm	
						production_method = pm_apple_orchards
					}	
				}
				AND = {
					can_activate_production_method = {
						building_type = building_wheat_farm	
						production_method = pm_citrus_orchards
					}
				}
				AND = {	
					can_activate_production_method = {
						building_type = building_rice_farm	
						production_method = pm_fig_orchards_building_rice_farm
					}
				}
				AND = {
					can_activate_production_method = {
						building_type = building_maize_farm	
						production_method = pm_citrus_orchards
					}
				}
				AND = {	
					can_activate_production_method = {
						building_type = building_millet_farm	
						production_method = pm_fig_orchards
					}
				}					
				AND = {
					can_activate_production_method = {
						building_type = building_logging_camp
						production_method = pm_saw_mills
					}
					market = { 
						mg:tools = { market_goods_delta >= 20 } 
					}	
				}
				AND = {
					can_activate_production_method = {
						building_type = building_livestock_ranch
						production_method = pm_butchering_tools
					}
					market = { 
						mg:tools = { market_goods_delta >= 10 } 
					}	
				}					
			}
		}			
	}
	
	on_start = {
		if = {
			limit = {
				market_capital = {
					owner = ROOT
				}
			}
			market_capital = {
				save_scope_as = tutorial_state_target
			}
		}
		else = {
			capital = {
				save_scope_as = tutorial_state_target
			}
		}

		if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_rye_farm	
						production_method = pm_apple_orchards
					}						
				}
			}
			
			scope:tutorial_state_target = {
				b:building_rye_farm = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_wheat_farm	
						production_method = pm_citrus_orchards
					}					
				}
			}
			
			scope:tutorial_state_target = {
				b:building_wheat_farm = { save_scope_as = tutorial_building_target }
			}				
		}
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_maize_farm	
						production_method = pm_citrus_orchards
					}						
				}
			}
			
			scope:tutorial_state_target = {
				b:building_maize_farm = { save_scope_as = tutorial_building_target }
			}			
		}	
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_rice_farm	
						production_method = pm_fig_orchards_building_rice_farm
					}					
				}
			}
			
			scope:tutorial_state_target = {
				b:building_rice_farm = { save_scope_as = tutorial_building_target }
			}					
		}
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_millet_farm	
						production_method = pm_fig_orchards
					}					
				}
			}
			
			scope:tutorial_state_target = {
				b:building_millet_farm = { save_scope_as = tutorial_building_target }
			}					
		}			
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_livestock_ranch
						production_method = pm_butchering_tools
					}
					market = { mg:tools = { market_goods_delta >= 10 } }						
				}
			}
			
			scope:tutorial_state_target = {
				b:building_livestock_ranch = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_logging_camp
						production_method = pm_saw_mills
					}
					market = { mg:tools = { market_goods_delta >= 20 } }						
				}
			}
			
			scope:tutorial_state_target = {
				b:building_logging_camp = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_rye_farm	
						production_method = pm_apple_orchards 
					}					
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_rye_farm	
						production_method = pm_apple_orchards 
					}					
				}
				
				b:building_rye_farm = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_wheat_farm	
						production_method = pm_citrus_orchards 
					}					
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_wheat_farm	
						production_method = pm_citrus_orchards 
					}						
				}
				
				b:building_wheat_farm = { save_scope_as = tutorial_building_target }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_maize_farm	
						production_method = pm_citrus_orchards 
					}						
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_maize_farm	
						production_method = pm_citrus_orchards 
					}					
				}
				
				b:building_maize_farm = { save_scope_as = tutorial_building_target }
			}			
		}	
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_rice_farm	
						production_method = pm_fig_orchards_building_rice_farm 
					}					
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_rice_farm	
						production_method = pm_fig_orchards_building_rice_farm 
					}						
				}
				
				b:building_rice_farm = { save_scope_as = tutorial_building_target }
			}					
		}
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_millet_farm	
						production_method = pm_fig_orchards 
					}					
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_millet_farm	
						production_method = pm_fig_orchards 
					}						
				}
				
				b:building_millet_farm = { save_scope_as = tutorial_building_target }
			}					
		}			
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_livestock_ranch
						production_method = pm_butchering_tools
					}
					market = { mg:tools = { market_goods_delta >= 10 } }						
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_livestock_ranch
						production_method = pm_butchering_tools
					}
					market = { mg:tools = { market_goods_delta >= 10 } }						
				}
				
				b:building_livestock_ranch = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_logging_camp
						production_method = pm_saw_mills
					}
					market = { mg:tools = { market_goods_delta >= 20 } }						
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_logging_camp
						production_method = pm_saw_mills
					}
					market = { mg:tools = { market_goods_delta >= 20 } }						
				}
				
				b:building_logging_camp = { save_scope_as = tutorial_building_target }
			}					
		}			
		
		add_journal_entry = {
			type = je_tutorial_change_production_method
			objective_subgoal = sg_change_production_method
			target = scope:tutorial_building_target
		}	
	}
}

# Expand Productive Building
sg_expand_productive_building = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_change_production_method
	}
	
	trigger = {
		any_scope_building = {
			can_queue_building_levels = 1
			is_under_construction = no
			is_government_funded = no
			is_subsidized = no
			NOT = { is_building_group = bg_owner_buildings }
			earnings >= 8.0
		}
	}
	
	on_start = {
		if = {
			limit = {
				market_capital = {
					owner = ROOT
				}
			}
			save_scope_as = tutorial_state_target
		}
		else = {
			capital = {
				save_scope_as = tutorial_state_target
			}
		}

		if = {
			limit = {
				scope:tutorial_state_target = {
					any_scope_building = {
						can_queue_building_levels = 1
						is_under_construction = no
						is_government_funded = no
						is_subsidized = no
						NOT = { is_building_group = bg_owner_buildings }
						earnings >= 8.0
					}
				}
			}
			
			scope:tutorial_state_target = {
				random_scope_building = {
					limit = {
						can_queue_building_levels = 1
						is_under_construction = no
						is_government_funded = no
						is_subsidized = no
						NOT = { is_building_group = bg_owner_buildings }
						earnings >= 8.0
					}
					
					save_scope_as = tutorial_building_target 
				}				
			}				
		}				
		else_if = {
			limit = {
				any_scope_building = {
					can_queue_building_levels = 1
					is_under_construction = no
					is_government_funded = no
					is_subsidized = no
					NOT = { is_building_group = bg_owner_buildings }
					earnings >= 8.0
				}
			}
			
			random_scope_building = {
				limit = {
					can_queue_building_levels = 1
					is_under_construction = no
					is_government_funded = no
					is_subsidized = no
					NOT = { is_building_group = bg_owner_buildings }
					earnings >= 8.0
				}
				
				save_scope_as = tutorial_building_target 
			}				
		}		
		
		add_journal_entry = {
			type = je_tutorial_expand_productive_building
			objective_subgoal = sg_expand_productive_building
			target = scope:tutorial_building_target
		}	
	}
}

# Fix Unproductive Building
sg_fix_unproductive_building = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_expand_productive_building
	}

	trigger = {
		any_scope_state = {
			NOT = { state_infrastructure_balance < 0 }
			any_scope_building = {
				is_government_funded = no
				NOR = { 
					is_building_type = building_urban_center
					is_building_type = building_trade_center
					is_building_group = bg_monuments_hidden
					is_building_group = bg_owner_buildings
				}
				is_under_construction = no
				is_subsidized = no
				is_subsistence_building = no
				earnings < 4.5
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				market_capital = {
					owner = ROOT
				}
			}
			save_scope_as = tutorial_state_target
		}
		else = {
			capital = {
				save_scope_as = tutorial_state_target
			}
		}
		
		if = {
			limit = {
				scope:tutorial_state_target = {
					any_scope_building = {
						NOT = { state_infrastructure_balance < 0 }
					}
					any_scope_building = {
						is_government_funded = no
						NOR = { 
							is_building_type = building_urban_center
							is_building_type = building_trade_center
							is_building_group = bg_monuments_hidden 
							is_building_group = bg_owner_buildings
						}
						is_under_construction = no
						is_subsidized = no
						is_subsistence_building = no
						earnings < 4.5
					}
				}
			}
			
			scope:tutorial_state_target = {
				random_scope_building = {
					limit = {
						is_government_funded = no
						NOR = { 
							is_building_type = building_urban_center
							is_building_type = building_trade_center
							is_building_group = bg_monuments_hidden
							is_building_group = bg_owner_buildings
						}
						is_under_construction = no
						is_subsidized = no
						is_subsistence_building = no
						earnings < 4.5
					}
					
					save_scope_as = tutorial_building_target 
				}				
			}				
		}				
		else_if = {
			limit = {
				any_scope_building = {
					is_government_funded = no
					NOR = { 
						is_building_type = building_urban_center
						is_building_type = building_trade_center
						is_building_group = bg_monuments_hidden
						is_building_group = bg_owner_buildings
					}
					is_under_construction = no
					is_subsidized = no
					is_subsistence_building = no
					earnings < 4.5
				}
			}
			
			random_scope_building = {
				limit = {
					is_government_funded = no
					NOR = { 
						is_building_type = building_urban_center
						is_building_type = building_trade_center
						is_building_group = bg_monuments_hidden
						is_building_group = bg_owner_buildings
					}
					is_under_construction = no
					is_subsidized = no
					is_subsistence_building = no
					earnings < 4.5
				}
				
				save_scope_as = tutorial_building_target 
			}				
		}
		
		add_journal_entry = {
			type = je_tutorial_fix_unproductive_building
			objective_subgoal = sg_fix_unproductive_building
			target = scope:tutorial_building_target
		}	
	}
}

# Bolster an Interest Group
sg_promote_ig = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_establish_trade_route
	}

	on_start = {
		add_journal_entry = {
			type = je_tutorial_promote_ig
			objective_subgoal = sg_promote_ig
		}	
	}
}

# Grow GDP
sg_grow_gdp = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_fix_unproductive_building
		sg_expand_productive_building
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_grow_gdp
			objective_subgoal = sg_grow_gdp
		}	
	}
}

# Improve Market Access by Decree
sg_increase_market_access_by_decree = {
	category = sgcat_tutorial

	unlocking_subgoals_any = {
		sg_expand_productive_building
	}

	trigger = {
		any_scope_state = {
			state_infrastructure_balance < 0
		}
	}

	on_start = {
		random_scope_state = {
			limit = {
				state_infrastructure_balance < 0
			}
			save_scope_as = tutorial_improve_market_state
		}

		add_journal_entry = {
			type = je_tutorial_increase_market_access_by_decree
			objective_subgoal = sg_increase_market_access_by_decree
			target = scope:tutorial_improve_market_state
		}
	}
}

# Improve Market Access by railways
sg_improve_market_access_with_railways = {
	category = sgcat_tutorial

	unlocking_subgoals_any = {
		sg_increase_market_access_by_decree
	}

	trigger = {
		any_scope_state = {
			state_infrastructure_balance < 0
		}
		has_technology_researched = railways
	}

	on_start = {
		random_scope_state = {
			limit = {
				state_infrastructure_balance < 0
			}
			save_scope_as = tutorial_improve_market_access_with_railways
		}

		add_journal_entry = {
			type = je_tutorial_improve_market_access_with_railways
			objective_subgoal = sg_improve_market_access_with_railways
			target = scope:tutorial_improve_market_access_with_railways
		}
	}
}

# Increase Immigration
sg_increase_immigration = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_increase_market_access_by_decree
	}

	trigger = {
		any_scope_state = {
			any_scope_building = {
				has_failed_hires = yes
			}
			available_jobs > 10000
		}
	}
	
	on_start = {
		random_scope_state = {
			limit = {
				any_scope_building = {
					has_failed_hires = yes
				}
				available_jobs > 10000
			}
			save_scope_as = tutorial_increase_immigration
		}

		add_journal_entry = {
			type = je_tutorial_increase_immigration
			objective_subgoal = sg_increase_immigration
			target = scope:tutorial_increase_immigration
		}
	}
}

# Establish Trade Route
sg_establish_trade_route = {
	category = sgcat_tutorial

	unlocking_subgoals_any = {
		sg_expand_productive_building
	}
	
	trigger = {
		market = {
			custom_tooltip = {
				text = suppress_localization_errors
				any_market_goods = {
					is_tradeable = yes
					market_goods_has_goods_shortage = yes
					root = {
						can_establish_any_import_route = prev.goods
					}
				}
			}
		}
	}
	
	on_start = {
		market = {
			ordered_market_goods = {
				limit = {
					is_tradeable = yes
					market_goods_has_goods_shortage = yes
					root = {
						can_establish_any_import_route = prev.goods
					}
				}
				order_by = { # reverse order
					value = 100
					subtract = num_import_trade_routes
				}
				save_scope_as = tutorial_establish_trade_route_goods
			}
		}

		add_journal_entry = {
			type = je_tutorial_establish_trade_route
			objective_subgoal = sg_establish_trade_route
			target = scope:tutorial_establish_trade_route_goods
		}
	}
}

# Improve Supply Network
sg_improve_supply_network = {
	category = sgcat_tutorial

	unlocking_subgoals_any = {
		sg_establish_trade_route
	}

	trigger = {
		any_scope_state = {
			is_coastal = yes
		}
		supply_network_strength < 1
	}

	on_start = {
		add_journal_entry = {
			type = je_tutorial_improve_supply_network
			objective_subgoal = sg_improve_supply_network
		}
	}
}

# Improve Access to Consumer Goods
sg_improve_consumer_goods_access = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_establish_trade_route
	}

	trigger = {
 		any_scope_state = {	
			OR = {
				sg:grain = { 
					state_goods_pricier > 0.25 
				}
				sg:fish = { 
					state_goods_pricier > 0.25 
				}
				sg:fabric = { 
					state_goods_pricier > 0.25 
				}
				sg:meat = { 
					state_goods_pricier > 0.25 
				}
				sg:clothes = { 
					state_goods_pricier > 0.25 
				}
				sg:furniture = { 
					state_goods_pricier > 0.25 
				}
				sg:groceries = { 
					state_goods_pricier > 0.25 
				}
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_scope_state = {
					sg:grain = { 
						state_goods_pricier > 0.25 
					}
				}
			}
			random_scope_state = {
				limit = {
					sg:grain = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:grain = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:fish = { 
						state_goods_pricier > 0.25
					}
				}		
			}
			random_scope_state = {
				limit = {
					sg:fish = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:fish = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:fabric = { 
						state_goods_pricier > 0.25
					}
				}	
			}
			random_scope_state = {
				limit = {
					sg:fabric = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:fabric = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:meat = { 
						state_goods_pricier > 0.25
					}
				}		
			}
			random_scope_state = {
				limit = {
					sg:meat = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:meat = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:clothes = { 
						state_goods_pricier > 0.25
					}
				}	
			}
			random_scope_state = {
				limit = {
					sg:clothes = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:clothes = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:furniture = { 
						state_goods_pricier > 0.25
					}
				}		
			}
			random_scope_state = {
				limit = {
					sg:furniture = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:furniture = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:groceries = { 
						state_goods_pricier > 0.25
					}
				}	
			}
			random_scope_state = {
				limit = {
					sg:groceries = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:groceries = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		add_journal_entry = {
			type = je_tutorial_improve_consumer_goods_access
			objective_subgoal = sg_improve_consumer_goods_access
			target = scope:tut_consumer_good_expensive
		}
	}
}

# Make Interest Group Happy
sg_make_interest_group_happy = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_promote_ig
	}

	trigger = {
		any_interest_group = {
			ig_approval < 2 
			is_marginal = no
		}
	}
	
	on_start = {
		random_interest_group = {
			limit = {
				ig_approval < 2
				is_marginal = no
			}
			save_scope_as = tut_unhappy_ig
		}

		add_journal_entry = {
			type = je_tutorial_make_interest_group_happy
			objective_subgoal = sg_make_interest_group_happy
			target = scope:tut_unhappy_ig
		}
	}
}

sg_enact_institution_law = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_promote_ig
	}

	trigger = {
		or = {
			and = {
				has_law = law_type:law_no_home_affairs
			}
			and = {
				has_law = law_type:law_no_health_system
			}
			and = {
				has_law = law_type:law_no_police
			}
			and = {
				has_law = law_type:law_no_social_security
			}
			and = {
			    NOT = { has_law = law_type:law_serfdom }
			    has_law = law_type:law_no_schools
			}
			and = {
				has_law = law_type:law_no_colonial_affairs
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
			    NOT = { has_law = law_type:law_serfdom }
			    has_law = law_type:law_no_schools
			}
			law_type:law_no_schools = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_police
			}
			law_type:law_no_police = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_health_system
			}
			law_type:law_no_health_system = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_home_affairs
			}
			law_type:law_no_home_affairs = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_social_security
			}
			law_type:law_no_social_security = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_colonial_affairs
			}
			law_type:law_no_colonial_affairs = {
				save_scope_as = tut_institution_lawtype
			}
		}

		add_journal_entry = {
			type = je_tutorial_enact_institution_law
			objective_subgoal = sg_enact_institution_law
			target = scope:tut_institution_lawtype
		}
	}
}

# Reform Government
sg_reform_government = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_promote_ig
	}

	trigger = {
		government_legitimacy <= 40
	}
	
	on_start = {		
		add_journal_entry = {
			type = je_tutorial_reform_government
			objective_subgoal = sg_reform_government
		}
	}
}

# Increase Relations
sg_increase_relations = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_enact_institution_law
		sg_reform_government
	}

	trigger = {
		OR = {
			any_country = {
				capital.region = {
					any_scope_interest_marker = {
						owner = root
					}
				}
				NOT = { this = ROOT }
				country_rank >= rank_value:major_power
				relations:root < relations_threshold:amicable
			}
			any_country = {
				has_attitude = {
					who = ROOT
					attitude >= cautious
				}
				country_rank >= rank_value:major_power
				relations:root < relations_threshold:amicable
			}
			any_country = {
				country_rank >= rank_value:major_power
				relations:root < relations_threshold:amicable
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_country = {
					capital.region = {
						any_scope_interest_marker = {
							owner = root
						}
					}
					NOT = { this = ROOT }
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
			}
			random_country = {
				limit = {
					capital.region = {
						any_scope_interest_marker = {
							owner = root
						}
					}
					NOT = { this = ROOT }
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
				save_scope_as = tut_increase_relations
			}
		}

		else_if = {
			limit = {
				any_country = {
					has_attitude = { 
						who = ROOT
						attitude >= cautious
					}
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
			}
			random_country = {
				limit = {
					has_attitude = { 
						who = ROOT
						attitude >= cautious
					}
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
				save_scope_as = tut_increase_relations
			}
		}

		else_if = {
			limit = {
				any_country = {
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
			}
			random_country = {
				limit = {
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
				save_scope_as = tut_increase_relations
			}
		}
		
		add_journal_entry = {
			type = je_tutorial_increase_relations
			objective_subgoal = sg_increase_relations
			target = scope:tut_increase_relations
		}
	}
}

# Improve Rank
sg_improve_rank = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_make_peace
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_improve_rank
			objective_subgoal = sg_improve_rank
		}
	}
}

# Prevent a Revolution
sg_prevent_revolution = { #currently code bug displays trigger wrong
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_make_interest_group_happy
	}

	trigger = {
		any_civil_war = {
			civil_war_progress >= 0.15
			is_civil_war_type = revolution
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_prevent_revolution
			objective_subgoal = sg_prevent_revolution
		}
	}
}

# Earn Obligation
sg_earn_obligation = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_increase_relations
	}

	trigger = {
		NOT = {
			any_country = { 
				owes_obligation_to = root
			}
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_earn_obligation
			objective_subgoal = sg_earn_obligation
			target = scope:tut_earn_obligation
		}
	}
}

# Expand Military
sg_expand_military = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_create_formation
	}

	trigger = {	
		any_military_formation = {
			is_army = yes
			owner = ROOT
		}
	}
	
	on_start = {
		random_military_formation = {
			limit = {
				is_army = yes
				owner = ROOT
			}
			save_scope_as = tut_expand_army
		}

		add_journal_entry = {
			type = je_tutorial_expand_military
			objective_subgoal = sg_expand_military
			target = scope:tut_expand_army
		}
	}
}

# Increase Command Limit
sg_recruit_promote_commander = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_expand_military
	}

	trigger = {	
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_recruit_promote_commander
			objective_subgoal = sg_recruit_promote_commander
			target = scope:tut_command_commander
		}
	}
}

# Mobilize Army
sg_mobilize_army = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_start_diplomatic_play
	}

	trigger = {
		any_military_formation = {
			is_army = yes
			is_mobilized = no
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_mobilize_army
			objective_subgoal = sg_mobilize_army
		}
	}
}

# Send General to Front
sg_send_general_to_front = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_mobilize_army
	}

	trigger = {
		any_military_formation = {
			is_army = yes
			is_mobilized = yes
			is_on_front = no
		}
	}
	
	on_start = {
		random_military_formation = {
			limit = {
				is_army = yes
				is_mobilized = yes
				is_on_front = no
			}
			save_scope_as = tut_send_general_to_front
		}

		add_journal_entry = {
			type = je_tutorial_send_general_to_front
			objective_subgoal = sg_send_general_to_front
			target = scope:tut_send_general_to_front
		}
	}
}

# Convoy Raiding
sg_convoy_raiding = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_recruit_promote_commander
	}

	trigger = {
		any_scope_character = {
			has_role = general
			NOT = { has_commander_order = defend }
		}
	}
	
	on_start = {
		random_scope_character = { 
			limit = {
				has_role = general
				NOT = { has_commander_order = defend }
			}
			save_scope_as = tut_convoy_raiding
		}
		
		add_journal_entry = {
			type = je_tutorial_convoy_raiding
			objective_subgoal = sg_convoy_raiding
			target = scope:tut_convoy_raiding
		}
	}
}

# Recover From Default
sg_recover_from_default = {
	category = sgcat_tutorial
	
	is_repeatable = yes
	
	unlocking_subgoals_any = {
	}

	trigger = {
		in_default = yes
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_recover_from_default
			objective_subgoal = sg_recover_from_default
		}
	}
}

# Start Diplomatic Play
sg_start_diplomatic_play = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_recruit_promote_commander
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_start_diplomatic_play
			objective_subgoal = sg_start_diplomatic_play
		}
	}
}

# Is Target in Diplomatic Play
sg_is_play_target = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_declare_an_interest
	}

	trigger = {
		is_diplomatic_play_target = yes
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_is_play_target
			objective_subgoal = sg_is_play_target
		}
	}
}

# Fix Capacity Deficit
sg_capacity_deficit = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
	}

	trigger = {
		OR = {
			bureaucracy < -10
			authority < -10
			influence < -10
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_capacity_deficit
			objective_subgoal = sg_capacity_deficit
		}
	}
}

sg_invest_into_an_institution = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_enact_institution_law
	}
	
	trigger = {
		OR = {
			institution:institution_schools = {
				investment < investment_max
			}
			institution:institution_health_system = {
				investment < investment_max
			}
			institution:institution_police = {
				investment < investment_max
			}
			institution:institution_social_security = {
				investment < investment_max
			}
			institution:institution_workplace_safety = {
				investment < investment_max
			}
			institution:institution_home_affairs = {
				investment < investment_max
			}
			institution:institution_colonial_affairs = {
				investment < investment_max
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				institution:institution_schools = {
					investment < investment_max
				}
			}
			institution:institution_schools = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_health_system = {
					investment < investment_max
				}
			}
			institution:institution_health_system = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_police = {
					investment < investment_max
				}
			}
			institution:institution_police = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_social_security = {
					investment < investment_max
				}
			}
			institution:institution_social_security = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_workplace_safety = {
					investment < investment_max
				}
			}
			institution:institution_workplace_safety = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_home_affairs = {
					investment < investment_max
				}
			}
			institution:institution_home_affairs = {
				save_scope_as = tut_institution
			}
		}
		
		else_if = {
			limit = {
				institution:institution_colonial_affairs = {
					investment < investment_max
				}
			}
			institution:institution_colonial_affairs = {
				save_scope_as = tut_institution
			}
		}
		
		add_journal_entry = {
			type = je_tutorial_invest_into_an_institution
			objective_subgoal = sg_invest_into_an_institution
			target = scope:tut_institution
		}
	}
}

# Incorporate State
sg_incorporate_state = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_invest_into_an_institution
	}

	trigger = {
		any_scope_state = {
			is_incorporated = no
			is_under_colonization = no
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_incorporate_state
			objective_subgoal = sg_incorporate_state
		}
	}
}

# Colonize Region
sg_colonize_state = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_declare_an_interest
	}

	on_start = {
		add_journal_entry = {
			type = je_tutorial_colonize_state
			objective_subgoal = sg_colonize_state
		}
	}
}

# Make Peace
sg_make_peace = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_send_general_to_front
	}

	trigger = {
		is_at_war = yes
	}

	on_start = {
		add_journal_entry = {
			type = je_tutorial_make_peace
			objective_subgoal = sg_make_peace
		}
	}
}

# Research Technology
sg_research_technology = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
	}

	trigger = {
		NOT = { is_researching_technology = any }
		has_researchable_technology = yes
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_research_technology
			objective_subgoal = sg_research_technology
		}
	}
}

# Declare an Interest
sg_declare_an_interest = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_increase_relations
	}

	on_start = {
		if = {
			limit = {
				any_rival_country = {
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
			}
			random_rival_country = {
				limit = {
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
				save_scope_as = tut_declare_interest_country
			}
		}

		else_if = {
			limit = {
				any_country = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
			}
			random_country = {
				limit = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
				save_scope_as = tut_declare_interest_country
			}
		}

		else_if = {
			limit = {
				any_country = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					relations:root < relations_threshold:amicable
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
			}
			random_country = {
				limit = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					country_rank >= rank_value:major_power
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
				save_scope_as = tut_declare_interest_country
			}
		}

		else_if = {
			limit = {
				any_country = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
			}
			random_country = {
				limit = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
				save_scope_as = tut_declare_interest_country
			}
		}

		add_journal_entry = {
			type = je_tutorial_declare_an_interest
			objective_subgoal = sg_declare_an_interest
			target = scope:tut_declare_interest_country
		}
	}
}

# Create Formation
sg_create_formation = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_declare_an_interest
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_create_formation
			objective_subgoal = sg_create_formation
		}
		set_variable = {
				name = formation_tutorial_ongoing
		}
	}
}

# Subject Liberty Desire
sg_subject_liberty = {
	category = sgcat_tutorial
	is_repeatable = no

	trigger = {
		any_country = {
			is_subject_of = ROOT
			liberty_desire >= 70
			liberty_desire_weekly_progress > 0
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_country = {
					is_subject_of = ROOT
					liberty_desire >= 70
					liberty_desire_weekly_progress > 0
				}
			}
			random_country = {
				limit = {
					is_subject_of = ROOT
					liberty_desire >= 70
					liberty_desire_weekly_progress > 0
				}
				save_scope_as = tut_subject_liberty_desire
			}
		}

		add_journal_entry = {
			type = je_subject_liberty
			objective_subgoal = sg_subject_liberty
			target = scope:tut_subject_liberty_desire
		}
	}
}

# Foreign Investment
sg_foreign_investment = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_subject_liberty
	}

	trigger = {
		any_country = {
			OR = {
				is_subject_of = ROOT
				has_diplomatic_pact = {
					who = root
					type = foreign_investment_agreement
				}
				root = {
					has_diplomatic_pact = {
						who = prev
						type = foreign_investment_rights
						is_initiator = yes
					}
				}
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_country = {
					OR = {
						is_subject_of = ROOT
						has_diplomatic_pact = {
							who = root
							type = foreign_investment_agreement
						}
						root = {
							has_diplomatic_pact = {
								who = prev
								type = foreign_investment_rights
								is_initiator = yes
							}
						}
					}
				}
			}
			random_country = {
				limit = {
					OR = {
						is_subject_of = ROOT
						has_diplomatic_pact = {
							who = root
							type = foreign_investment_agreement
						}
						root = {
							has_diplomatic_pact = {
								who = prev
								type = foreign_investment_rights
								is_initiator = yes
							}
						}
					}
				}
				save_scope_as = tut_foreign_investment
			}
		}

		add_journal_entry = {
			type = je_tutorial_foreign_investment
			objective_subgoal = sg_foreign_investment
			target = scope:tut_foreign_investment
		}	
	}
}

# Establish Company
sg_establish_company = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expand_productive_building
	}

	trigger = {
		can_establish_company = YES
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_establish_company
			objective_subgoal = sg_establish_company
		}	
	}
}

# Form Power Bloc
sg_form_power_bloc = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
	}

	trigger = {
		OR = {
			country_rank = rank_value:great_power
			AND = {
				country_rank = rank_value:major_power
				has_variable = tutorial_form_pb_end
			}
		}
		is_in_power_bloc = no
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_form_power_bloc
			objective_subgoal = sg_form_power_bloc
		}	
	}
}

# Lobbies
sg_lobbies = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_increase_relations
	}

	trigger = {
		any_political_lobby = {
			appeasement <= 7
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_political_lobby = {
					OR = {
						is_political_lobby_type = lobby_pro_country
						is_political_lobby_type = lobby_anti_country
					}
				}
			}
			random_political_lobby = {
				limit = {
					OR = {
						is_political_lobby_type = lobby_pro_country
						is_political_lobby_type = lobby_anti_country
					}
				}
				save_scope_as = tut_political_lobby
			}
		}

		add_journal_entry = {
			type = je_tutorial_lobbies
			objective_subgoal = sg_lobbies
			target = scope:tut_political_lobby
		}
	}
}
﻿sg_expand_goods_production = {
	category = sgcat_economic_dominance

	trigger = {
		any_scope_building = {
			is_under_construction = no
			can_queue_building_levels = 1
			is_economic_objective_building = yes
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_scope_building = {
					can_queue_building_levels = 1
					is_building_type = building_iron_mine
				}
			}
			random_scope_building = {
				limit = { 
					can_queue_building_levels = 1
					is_building_type = building_iron_mine
				}
				save_scope_as = economic_building_target
			}				
		}
		
		else_if = {
			limit = {
				any_scope_building = {
					can_queue_building_levels = 1
					is_building_type = building_coal_mine
				}
			}
			random_scope_building = {
				limit = { 
					can_queue_building_levels = 1
					is_building_type = building_coal_mine
				}
				save_scope_as = economic_building_target
			}
		}

		add_journal_entry = {
			type = je_objective_expand_goods_production
			objective_subgoal = sg_expand_goods_production
			target = scope:economic_building_target
		}
	}
}

sg_refining_goods = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expand_goods_production
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_refining_goods
			objective_subgoal = sg_refining_goods
		}	
	}
}

sg_specialized_goods = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_refining_goods
	}

	trigger = { 
	}
	
	on_start = {
		add_journal_entry = {
			type = je_specialized_goods
			objective_subgoal = sg_specialized_goods
		}
	}
}

sg_expanding_the_market = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_specialized_goods
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_expanding_the_market
			objective_subgoal = sg_expanding_the_market
		}
	}
}

sg_strong_market = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expanding_the_market
		sg_lower_production_costs
	}

	unlocking_subgoals_any = {
		sg_raise_exports_value
		sg_utilizing_our_strength
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_strong_market
			objective_subgoal = sg_strong_market
		}
	}
}

sg_specialized_inputs = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_specialized_goods
	}

	trigger = {
		NOT = { has_variable = player_obj_export_focus }
	}
	
	on_start = {
		add_journal_entry = {
			type = je_specialized_inputs
			objective_subgoal = sg_specialized_inputs
		}
	}
}

sg_utilizing_our_strength = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_specialized_goods
	}

	trigger = {
		has_variable = player_obj_home_focus
	}
	
	on_start = {
		add_journal_entry = {
			type = je_utilizing_our_strength
			objective_subgoal = sg_utilizing_our_strength
		}	
	}
}

sg_exporting_profits = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_specialized_goods
	}

	trigger = {
		NOT = { has_variable = player_obj_home_focus }
	}
	
	on_start = {
		add_journal_entry = {
			type = je_exporting_profits
			objective_subgoal = sg_exporting_profits
		}	
	}
}

sg_raise_exports_value = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_exporting_profits
	}

	trigger = {
		has_variable = player_obj_export_focus
	}
	
	on_start = {
		add_journal_entry = {
			type = je_raise_exports_value
			objective_subgoal = sg_raise_exports_value
		}	
	}
}

sg_lower_production_costs = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_refining_goods
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_lower_production_costs
			objective_subgoal = sg_lower_production_costs
		}	
	}
}
﻿sg_encourage_liberal_ideas = {
	category = sgcat_economic_dominance
	is_repeatable = no

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_objective_encourage_liberal_ideas
			objective_subgoal = sg_encourage_liberal_ideas
		}
	}
}

sg_liberate_the_slaves = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	trigger = { 
	}
	
	on_start = {
		add_journal_entry = {
			type = je_liberate_the_slaves
			objective_subgoal = sg_liberate_the_slaves
			target = scope:slavery_objective_target
		}
	}
}

sg_pass_laws = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	unlocking_subgoals_any = {
		sg_encourage_liberal_ideas
		sg_liberate_the_slaves
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_pass_laws
			objective_subgoal = sg_pass_laws
		}	
	}
}

sg_public_services = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_pass_laws
	}

	trigger = {
		NOT = { has_law = law_type:law_state_religion }
		has_law = law_type:law_multicultural
		has_law = law_type:law_public_schools
		has_law = law_type:law_protected_speech
	}
	
	on_start = {
		add_journal_entry = {
			type = je_public_services
			objective_subgoal = sg_public_services
		}	
	}
}

sg_women_and_children = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_public_services
	}

	trigger = {
		NOT = { has_law = law_type:law_state_religion }
		has_law = law_type:law_multicultural
		has_law = law_type:law_public_schools
		has_law = law_type:law_protected_speech
	}
	
	on_start = {
		add_journal_entry = {
			type = je_women_and_children
			objective_subgoal = sg_women_and_children
		}
	}
}

sg_egalitarian_society = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_women_and_children
		sg_liberate_the_slaves 
	}

	trigger = {
		NOT = { has_law = law_type:law_state_religion }
		has_law = law_type:law_multicultural
		has_law = law_type:law_public_schools
		has_law = law_type:law_protected_speech
		has_law = law_type:law_compulsory_primary_school
		has_law = law_type:law_womens_suffrage
	}
	
	on_start = {
		add_journal_entry = {
			type = je_egalitarian_society
			objective_subgoal = sg_egalitarian_society
		}
	}
}
﻿sg_colonization_laws = {
	category = sgcat_hegemon
	is_repeatable = no

	trigger = {
	}
	
	on_start = {
		if = {
			limit = {
				ROOT = {
					country_rank = rank_value:great_power
				}
			}
			set_variable = objective_country_great
		}

		else_if = {
			limit = {
				ROOT = {
					country_rank = rank_value:major_power
				}
			}
			set_variable = objective_country_major
		}
		
		else_if = {
			limit = {
				ROOT = {
					country_rank <= rank_value:minor_power
				}
			}
			set_variable = objective_country_minor
		}

		else_if = {
			limit = {
				ROOT = {
					country_rank <= rank_value:unrecognized_major_power
				}
			}
			set_variable = objective_country_unrecognized
		}

		add_journal_entry = {
			type = je_colonization_laws
			objective_subgoal = sg_colonization_laws
		}
	}
}

sg_african_colonies = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_colonization_laws
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_african_colonies
			objective_subgoal = sg_african_colonies
		}
	}
}

sg_expand_navy_and_army = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_african_colonies
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_expand_navy_and_army
			objective_subgoal = sg_expand_navy_and_army
		}
	}
}

sg_form_alliance = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_colonization_laws
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_form_alliance
			objective_subgoal = sg_form_alliance
		}
	}
}

sg_take_subject = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_colonization_laws
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_take_subject
			objective_subgoal = sg_take_subject
		}
	}
}

sg_increase_technology = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expand_navy_and_army
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_increase_technology
			objective_subgoal = sg_increase_technology
		}
	}
}

sg_greatest_power = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_colonization_laws
	}

	trigger = {
		has_variable = objective_country_great
	}
	
	on_start = {
		add_journal_entry = {
			type = je_greatest_power
			objective_subgoal = sg_greatest_power
		}
	}
}

sg_greater_power = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_colonization_laws
	}

	trigger = {
		has_variable = objective_country_major
	}
	
	on_start = {
		add_journal_entry = {
			type = je_greater_power
			objective_subgoal = sg_greater_power
		}
	}
}

sg_great_power = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_colonization_laws
	}

	trigger = {
		has_variable = objective_country_minor
	}
	
	on_start = {
		add_journal_entry = {
			type = je_great_power
			objective_subgoal = sg_great_power
		}
	}
}

sg_unrecognized_power = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_colonization_laws
	}

	trigger = {
		has_variable = objective_country_unrecognized
	}
	
	on_start = {
		add_journal_entry = {
			type = je_unrecognized_power
			objective_subgoal = sg_unrecognized_power
		}
	}
}

sg_the_hegemon = {
	category = sgcat_hegemon
	is_repeatable = no

	unlocking_subgoals_any = {
		sg_great_power
		sg_greater_power
		sg_greatest_power
		sg_unrecognized_power
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_the_hegemon
			objective_subgoal = sg_the_hegemon
		}
	}
}

﻿sg_great_game = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		OR = {
			c:GBR ?= this
			c:RUS ?= this
			c:PER ?= this
			is_afghan_nation = yes
		}
		NOT = {
			has_global_variable = great_game_failed
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_great_game_control
			objective_subgoal = sg_great_game
		}
	}
}

sg_maintain_afghan_protectorate = {
	category = sgcat_great_game
	is_repeatable = no

	unlocking_subgoals_all = {

	}

	trigger = {
		NOT = {
			has_global_variable = gg_afghanistan_protectorate_done
		}
		has_interest_marker_in_region = region_persia
		OR = {
			c:GBR?= THIS
			c:RUS ?= THIS
		}
		has_journal_entry = je_great_game_control
	}

	on_start = {
		add_journal_entry = {
			type = je_maintain_afghan_protectorate
			objective_subgoal = sg_maintain_afghan_protectorate
		}
	}
}

sg_disrupt_russian_caucasus = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:GBR?= THIS
		exists = c:CIR
		has_journal_entry = je_great_game_control
	}
	
	on_start = {
		add_journal_entry = {
			type = je_disrupt_russian_caucasus
			objective_subgoal = sg_disrupt_russian_caucasus
		}
	}
}

sg_counter_russian_pacific_influence = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:GBR?= THIS
		c:RUS ?= {
			any_scope_state = {
				region = sr:region_manchuria
				OR = {
					any_scope_building = {
						is_building_type = building_port
						level >= 5
					}
					any_scope_building = {
						is_building_type = building_naval_base
						level >= 15
					}
				}
			}
		}
		has_journal_entry = je_great_game_control
	}

	on_start = {
		add_journal_entry = {
			type = je_counter_russian_pacific_influence
			objective_subgoal = sg_counter_russian_pacific_influence
		}
	}
}

sg_consolidate_british_india = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:GBR?= THIS
		c:BIC ?= {
			is_subject_of = c:GBR
		}
		has_journal_entry = je_great_game_control
	}

	on_start = {
		add_journal_entry = {
			type = je_consolidate_british_india
			objective_subgoal = sg_consolidate_british_india
		}
	}
}

sg_repulse_russian_pamirs = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:GBR?= THIS
		c:RUS ?= {
			OR = {
				any_scope_state = {
					state_region = s:STATE_TAJIKISTAN
				}
				any_subject_or_below = {
					any_scope_state = {
						state_region = s:STATE_TAJIKISTAN
					}
				}
			}
		}
		has_journal_entry = je_great_game_control
		NOT = {
			has_variable = dismissed_pamir_expedition
		}
	}

	on_start = {
		add_journal_entry = {
			type = je_pamir_expedition_objective
			objective_subgoal = sg_repulse_russian_pamirs
		}
	}
}

sg_consolidate_afghanistan = {
	category = sgcat_great_game
	is_repeatable = no

	unlocking_subgoals_all = {

	}

	trigger = {
		has_interest_marker_in_region = region_persia
		OR = {
			c:GBR?= THIS
			c:RUS ?= THIS
		}
		has_journal_entry = je_great_game_control
		exists = c:AFG
	}

	on_start = {
		add_journal_entry = {
			type = je_consolidate_afghanistan_objective
			objective_subgoal = sg_consolidate_afghanistan
		}
	}
}

sg_secure_persian_border = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:RUS ?= THIS
		exists = c:CIR
		has_journal_entry = je_great_game_control
	}
	
	on_start = {
		add_journal_entry = {
			type = je_secure_persian_border
			objective_subgoal = sg_secure_persian_border
		}
	}
}

sg_unify_afghanistan = {
	category = sgcat_great_game
	is_repeatable = no

	unlocking_subgoals_all = {

	}

	trigger = {
		is_afghan_nation = yes
		has_journal_entry = je_great_game_control
	}

	on_start = {
		add_journal_entry = {
			type = je_unify_afghanistan_objective
			objective_subgoal = sg_unify_afghanistan
		}
	}
}
sg_pacify_kazakh_steppe = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:RUS ?= THIS
		has_journal_entry = je_pacify_the_steppes
		has_journal_entry = je_great_game_control
	}
	
	on_start = {
		add_journal_entry = {
			type = je_pacify_kazakh_steppes
			objective_subgoal = sg_pacify_kazakh_steppe
		}
	}
}

sg_codify_chinese_border = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:RUS ?= THIS
		has_technology_researched = nationalism
		has_journal_entry = je_great_game_control
	}
	
	on_start = {
		add_journal_entry = {
			type = je_codify_chinese_border
			objective_subgoal = sg_codify_chinese_border
		}
	}
}

sg_consolidate_central_asia = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:RUS ?= THIS
		has_technology_researched = nationalism
		has_journal_entry = je_great_game_control
	}
	
	on_start = {
		add_journal_entry = {
			type = je_consolidate_central_asia
			objective_subgoal = sg_consolidate_central_asia
		}
	}
}

sg_acquire_chinese_concessions = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:RUS ?= THIS
		has_technology_researched = railways
		any_scope_state = {
			OR = {
				state_region = s:STATE_OUTER_MANCHURIA
				state_region = s:STATE_AMUR
			}
			is_incorporated = yes
		}
		has_journal_entry = je_great_game_control
	}
	
	on_start = {
		add_journal_entry = {
			type = je_chinese_concessions
			objective_subgoal = sg_acquire_chinese_concessions
		}
	}
}

sg_acquire_korean_protectorate = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:RUS ?= THIS
        any_neighbouring_state = {
            owner = c:KOR
			is_incorporated = yes
        }
		c:KOR ?= {
			is_country_type = unrecognized
		}
		has_journal_entry = je_great_game_control
	}
	
	on_start = {
		set_global_variable = korean_protectorate_started
		add_journal_entry = {
			type = je_acquire_korean_protectorate
			objective_subgoal = sg_acquire_korean_protectorate
		}
	}
}

sg_expand_eastern_frontier = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:PER ?= this
		has_journal_entry = je_great_game_control
	}

	on_start = {
		add_journal_entry = {
			type = je_eastern_frontier
			objective_subgoal = sg_expand_eastern_frontier
		}
	}
}

sg_secure_influence_over_persia = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		has_interest_marker_in_region = region_persia
		OR = {
			c:GBR?= THIS
			c:RUS ?= THIS
		}
		has_journal_entry = je_great_game_control
	}

	on_start = {
		add_journal_entry = {
			type = je_secure_influence_over_persia
			objective_subgoal = sg_secure_influence_over_persia
		}
	}
}

sg_consolidate_persia = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		c:PER ?= this
		has_journal_entry = je_great_game_control
	}

	on_start = {
		add_journal_entry = {
			type = je_consolidate_persia
			objective_subgoal = sg_consolidate_persia
		}
	}
}

sg_achieve_sovereignty = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		OR = {
			c:PER ?= this
			is_afghan_nation = yes
		}
		is_country_type = unrecognized
		has_journal_entry = je_great_game_control
	}

	on_start = {
		add_journal_entry = {
			type = je_achieve_sovereignty
			objective_subgoal = sg_achieve_sovereignty
		}
	}
}

sg_secure_tibet = {
	category = sgcat_great_game
	is_repeatable = no

	trigger = {
		NOT = { c:TIB ?= THIS }
		exists = c:TIB
		country_rank >= rank_value:great_power
		OR = {
			is_country_type = recognized
			is_country_type = colonial
		}
		has_variable = tibet_has_started
		NOT = { has_global_variable = tibet_expedition_completed }
		has_interest_marker_in_region = region_himalayas
		has_journal_entry = je_great_game_control
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tibet_expedition
			objective_subgoal = sg_secure_tibet
		}
	}
}

﻿﻿sg_expand_basic_building = {
	category = sgcat_tutorial

	trigger = {
		any_scope_building = {
			is_under_construction = no
			is_farm_building = yes
			can_queue_building_levels = 1
		}
	}
	
	on_start = {
		start_tutorial_lesson = { tutorial_lesson = lesson_journal }
		
		if = {
			limit = {
				market_capital = {
					owner = ROOT
				}
			}
			save_scope_as = tutorial_state_target	
		}
		else = {
			capital = {
				save_scope_as = tutorial_state_target
			}
		}

		if = {
			limit = {
				scope:tutorial_state_target = {
					any_scope_building = {
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}					
				}
			}
			scope:tutorial_state_target = {
				random_scope_building = {
					limit = {	
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}
					save_scope_as = tutorial_building_target

				}			
			}
		}
		else_if = {
			limit = {
				any_scope_state = {
					is_incorporated = yes
					any_scope_building = {
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}					
				}				
			}
			
			random_scope_state = {
				limit = { 
					is_incorporated = yes
					any_scope_building = {
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}
				}
				
				random_scope_building = {
					limit = {	
						is_under_construction = no
						is_farm_building = yes
						can_queue_building_levels = 1
					}
					save_scope_as = tutorial_building_target
				}						
			}			
		}
		else = {
			random_scope_building = {
				limit = {	
					is_under_construction = no
					is_farm_building = yes
					can_queue_building_levels = 1
				}
				save_scope_as = tutorial_building_target
			}	
		}

		add_journal_entry = {
			type = je_tutorial_expand_basic_building
			objective_subgoal = sg_expand_basic_building
			target = scope:tutorial_building_target
		}			
	}
}

# Fix Budget Deficit
sg_fix_budget_deficit = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expand_productive_building
	}

	trigger = {
		gold_reserves = 0
		weekly_net_fixed_income <= -1000 # Do not trigger this based on a tiny deficit that will self-correct
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_fix_budget_deficit
			objective_subgoal = sg_fix_budget_deficit
		}	
	}
}

# Change Production Method
sg_change_production_method = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_expand_basic_building
	}

	trigger = {
		any_scope_state = {
			OR = {
				AND = {
					can_activate_production_method = {
						building_type = building_rye_farm	
						production_method = pm_apple_orchards
					}	
				}
				AND = {
					can_activate_production_method = {
						building_type = building_wheat_farm	
						production_method = pm_citrus_orchards
					}
				}
				AND = {	
					can_activate_production_method = {
						building_type = building_rice_farm	
						production_method = pm_fig_orchards_building_rice_farm
					}
				}
				AND = {
					can_activate_production_method = {
						building_type = building_maize_farm	
						production_method = pm_citrus_orchards
					}
				}
				AND = {	
					can_activate_production_method = {
						building_type = building_millet_farm	
						production_method = pm_fig_orchards
					}
				}					
				AND = {
					can_activate_production_method = {
						building_type = building_logging_camp
						production_method = pm_saw_mills
					}
					market = { 
						mg:tools = { market_goods_delta >= 20 } 
					}	
				}
				AND = {
					can_activate_production_method = {
						building_type = building_livestock_ranch
						production_method = pm_butchering_tools
					}
					market = { 
						mg:tools = { market_goods_delta >= 10 } 
					}	
				}					
			}
		}			
	}
	
	on_start = {
		if = {
			limit = {
				market_capital = {
					owner = ROOT
				}
			}
			market_capital = {
				save_scope_as = tutorial_state_target
			}
		}
		else = {
			capital = {
				save_scope_as = tutorial_state_target
			}
		}

		if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_rye_farm	
						production_method = pm_apple_orchards
					}						
				}
			}
			
			scope:tutorial_state_target = {
				b:building_rye_farm = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_wheat_farm	
						production_method = pm_citrus_orchards
					}					
				}
			}
			
			scope:tutorial_state_target = {
				b:building_wheat_farm = { save_scope_as = tutorial_building_target }
			}				
		}
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_maize_farm	
						production_method = pm_citrus_orchards
					}						
				}
			}
			
			scope:tutorial_state_target = {
				b:building_maize_farm = { save_scope_as = tutorial_building_target }
			}			
		}	
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_rice_farm	
						production_method = pm_fig_orchards_building_rice_farm
					}					
				}
			}
			
			scope:tutorial_state_target = {
				b:building_rice_farm = { save_scope_as = tutorial_building_target }
			}					
		}
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_millet_farm	
						production_method = pm_fig_orchards
					}					
				}
			}
			
			scope:tutorial_state_target = {
				b:building_millet_farm = { save_scope_as = tutorial_building_target }
			}					
		}			
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_livestock_ranch
						production_method = pm_butchering_tools
					}
					market = { mg:tools = { market_goods_delta >= 10 } }						
				}
			}
			
			scope:tutorial_state_target = {
				b:building_livestock_ranch = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				scope:tutorial_state_target = {
					can_activate_production_method = {
						building_type = building_logging_camp
						production_method = pm_saw_mills
					}
					market = { mg:tools = { market_goods_delta >= 20 } }						
				}
			}
			
			scope:tutorial_state_target = {
				b:building_logging_camp = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_rye_farm	
						production_method = pm_apple_orchards 
					}					
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_rye_farm	
						production_method = pm_apple_orchards 
					}					
				}
				
				b:building_rye_farm = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_wheat_farm	
						production_method = pm_citrus_orchards 
					}					
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_wheat_farm	
						production_method = pm_citrus_orchards 
					}						
				}
				
				b:building_wheat_farm = { save_scope_as = tutorial_building_target }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_maize_farm	
						production_method = pm_citrus_orchards 
					}						
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_maize_farm	
						production_method = pm_citrus_orchards 
					}					
				}
				
				b:building_maize_farm = { save_scope_as = tutorial_building_target }
			}			
		}	
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_rice_farm	
						production_method = pm_fig_orchards_building_rice_farm 
					}					
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_rice_farm	
						production_method = pm_fig_orchards_building_rice_farm 
					}						
				}
				
				b:building_rice_farm = { save_scope_as = tutorial_building_target }
			}					
		}
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_millet_farm	
						production_method = pm_fig_orchards 
					}					
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_millet_farm	
						production_method = pm_fig_orchards 
					}						
				}
				
				b:building_millet_farm = { save_scope_as = tutorial_building_target }
			}					
		}			
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_livestock_ranch
						production_method = pm_butchering_tools
					}
					market = { mg:tools = { market_goods_delta >= 10 } }						
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_livestock_ranch
						production_method = pm_butchering_tools
					}
					market = { mg:tools = { market_goods_delta >= 10 } }						
				}
				
				b:building_livestock_ranch = { save_scope_as = tutorial_building_target }
			}					
		}	
		else_if = {
			limit = {
				any_scope_state = {
					can_activate_production_method = {
						building_type = building_logging_camp
						production_method = pm_saw_mills
					}
					market = { mg:tools = { market_goods_delta >= 20 } }						
				}
			}
			
			random_scope_state = {
				limit = {
					can_activate_production_method = {
						building_type = building_logging_camp
						production_method = pm_saw_mills
					}
					market = { mg:tools = { market_goods_delta >= 20 } }						
				}
				
				b:building_logging_camp = { save_scope_as = tutorial_building_target }
			}					
		}			
		
		add_journal_entry = {
			type = je_tutorial_change_production_method
			objective_subgoal = sg_change_production_method
			target = scope:tutorial_building_target
		}	
	}
}

# Expand Productive Building
sg_expand_productive_building = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_change_production_method
	}
	
	trigger = {
		any_scope_building = {
			can_queue_building_levels = 1
			is_under_construction = no
			is_government_funded = no
			is_subsidized = no
			NOT = { is_building_group = bg_owner_buildings }
			earnings >= 8.0
		}
	}
	
	on_start = {
		if = {
			limit = {
				market_capital = {
					owner = ROOT
				}
			}
			save_scope_as = tutorial_state_target
		}
		else = {
			capital = {
				save_scope_as = tutorial_state_target
			}
		}

		if = {
			limit = {
				scope:tutorial_state_target = {
					any_scope_building = {
						can_queue_building_levels = 1
						is_under_construction = no
						is_government_funded = no
						is_subsidized = no
						NOT = { is_building_group = bg_owner_buildings }
						earnings >= 8.0
					}
				}
			}
			
			scope:tutorial_state_target = {
				random_scope_building = {
					limit = {
						can_queue_building_levels = 1
						is_under_construction = no
						is_government_funded = no
						is_subsidized = no
						NOT = { is_building_group = bg_owner_buildings }
						earnings >= 8.0
					}
					
					save_scope_as = tutorial_building_target 
				}				
			}				
		}				
		else_if = {
			limit = {
				any_scope_building = {
					can_queue_building_levels = 1
					is_under_construction = no
					is_government_funded = no
					is_subsidized = no
					NOT = { is_building_group = bg_owner_buildings }
					earnings >= 8.0
				}
			}
			
			random_scope_building = {
				limit = {
					can_queue_building_levels = 1
					is_under_construction = no
					is_government_funded = no
					is_subsidized = no
					NOT = { is_building_group = bg_owner_buildings }
					earnings >= 8.0
				}
				
				save_scope_as = tutorial_building_target 
			}				
		}		
		
		add_journal_entry = {
			type = je_tutorial_expand_productive_building
			objective_subgoal = sg_expand_productive_building
			target = scope:tutorial_building_target
		}	
	}
}

# Fix Unproductive Building
sg_fix_unproductive_building = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_expand_productive_building
	}

	trigger = {
		any_scope_state = {
			NOT = { state_infrastructure_balance < 0 }
			any_scope_building = {
				is_government_funded = no
				NOR = { 
					is_building_type = building_urban_center
					is_building_type = building_trade_center
					is_building_group = bg_monuments_hidden
					is_building_group = bg_owner_buildings
				}
				is_under_construction = no
				is_subsidized = no
				is_subsistence_building = no
				earnings < 4.5
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				market_capital = {
					owner = ROOT
				}
			}
			save_scope_as = tutorial_state_target
		}
		else = {
			capital = {
				save_scope_as = tutorial_state_target
			}
		}
		
		if = {
			limit = {
				scope:tutorial_state_target = {
					any_scope_building = {
						NOT = { state_infrastructure_balance < 0 }
					}
					any_scope_building = {
						is_government_funded = no
						NOR = { 
							is_building_type = building_urban_center
							is_building_type = building_trade_center
							is_building_group = bg_monuments_hidden 
							is_building_group = bg_owner_buildings
						}
						is_under_construction = no
						is_subsidized = no
						is_subsistence_building = no
						earnings < 4.5
					}
				}
			}
			
			scope:tutorial_state_target = {
				random_scope_building = {
					limit = {
						is_government_funded = no
						NOR = { 
							is_building_type = building_urban_center
							is_building_type = building_trade_center
							is_building_group = bg_monuments_hidden
							is_building_group = bg_owner_buildings
						}
						is_under_construction = no
						is_subsidized = no
						is_subsistence_building = no
						earnings < 4.5
					}
					
					save_scope_as = tutorial_building_target 
				}				
			}				
		}				
		else_if = {
			limit = {
				any_scope_building = {
					is_government_funded = no
					NOR = { 
						is_building_type = building_urban_center
						is_building_type = building_trade_center
						is_building_group = bg_monuments_hidden
						is_building_group = bg_owner_buildings
					}
					is_under_construction = no
					is_subsidized = no
					is_subsistence_building = no
					earnings < 4.5
				}
			}
			
			random_scope_building = {
				limit = {
					is_government_funded = no
					NOR = { 
						is_building_type = building_urban_center
						is_building_type = building_trade_center
						is_building_group = bg_monuments_hidden
						is_building_group = bg_owner_buildings
					}
					is_under_construction = no
					is_subsidized = no
					is_subsistence_building = no
					earnings < 4.5
				}
				
				save_scope_as = tutorial_building_target 
			}				
		}
		
		add_journal_entry = {
			type = je_tutorial_fix_unproductive_building
			objective_subgoal = sg_fix_unproductive_building
			target = scope:tutorial_building_target
		}	
	}
}

# Bolster an Interest Group
sg_promote_ig = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_establish_trade_route
	}

	on_start = {
		add_journal_entry = {
			type = je_tutorial_promote_ig
			objective_subgoal = sg_promote_ig
		}	
	}
}

# Grow GDP
sg_grow_gdp = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_fix_unproductive_building
		sg_expand_productive_building
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_grow_gdp
			objective_subgoal = sg_grow_gdp
		}	
	}
}

# Improve Market Access by Decree
sg_increase_market_access_by_decree = {
	category = sgcat_tutorial

	unlocking_subgoals_any = {
		sg_expand_productive_building
	}

	trigger = {
		any_scope_state = {
			state_infrastructure_balance < 0
		}
	}

	on_start = {
		random_scope_state = {
			limit = {
				state_infrastructure_balance < 0
			}
			save_scope_as = tutorial_improve_market_state
		}

		add_journal_entry = {
			type = je_tutorial_increase_market_access_by_decree
			objective_subgoal = sg_increase_market_access_by_decree
			target = scope:tutorial_improve_market_state
		}
	}
}

# Improve Market Access by railways
sg_improve_market_access_with_railways = {
	category = sgcat_tutorial

	unlocking_subgoals_any = {
		sg_increase_market_access_by_decree
	}

	trigger = {
		any_scope_state = {
			state_infrastructure_balance < 0
		}
		has_technology_researched = railways
	}

	on_start = {
		random_scope_state = {
			limit = {
				state_infrastructure_balance < 0
			}
			save_scope_as = tutorial_improve_market_access_with_railways
		}

		add_journal_entry = {
			type = je_tutorial_improve_market_access_with_railways
			objective_subgoal = sg_improve_market_access_with_railways
			target = scope:tutorial_improve_market_access_with_railways
		}
	}
}

# Increase Immigration
sg_increase_immigration = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_increase_market_access_by_decree
	}

	trigger = {
		any_scope_state = {
			any_scope_building = {
				has_failed_hires = yes
			}
			available_jobs > 10000
		}
	}
	
	on_start = {
		random_scope_state = {
			limit = {
				any_scope_building = {
					has_failed_hires = yes
				}
				available_jobs > 10000
			}
			save_scope_as = tutorial_increase_immigration
		}

		add_journal_entry = {
			type = je_tutorial_increase_immigration
			objective_subgoal = sg_increase_immigration
			target = scope:tutorial_increase_immigration
		}
	}
}

# Establish Trade Route
sg_establish_trade_route = {
	category = sgcat_tutorial

	unlocking_subgoals_any = {
		sg_expand_productive_building
	}
	
	trigger = {
		market = {
			custom_tooltip = {
				text = suppress_localization_errors
				any_market_goods = {
					is_tradeable = yes
					market_goods_has_goods_shortage = yes
					root = {
						can_establish_any_import_route = prev.goods
					}
				}
			}
		}
	}
	
	on_start = {
		market = {
			ordered_market_goods = {
				limit = {
					is_tradeable = yes
					market_goods_has_goods_shortage = yes
					root = {
						can_establish_any_import_route = prev.goods
					}
				}
				order_by = { # reverse order
					value = 100
					subtract = num_import_trade_routes
				}
				save_scope_as = tutorial_establish_trade_route_goods
			}
		}

		add_journal_entry = {
			type = je_tutorial_establish_trade_route
			objective_subgoal = sg_establish_trade_route
			target = scope:tutorial_establish_trade_route_goods
		}
	}
}

# Improve Supply Network
sg_improve_supply_network = {
	category = sgcat_tutorial

	unlocking_subgoals_any = {
		sg_establish_trade_route
	}

	trigger = {
		any_scope_state = {
			is_coastal = yes
		}
		supply_network_strength < 1
	}

	on_start = {
		add_journal_entry = {
			type = je_tutorial_improve_supply_network
			objective_subgoal = sg_improve_supply_network
		}
	}
}

# Improve Access to Consumer Goods
sg_improve_consumer_goods_access = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_establish_trade_route
	}

	trigger = {
 		any_scope_state = {	
			OR = {
				sg:grain = { 
					state_goods_pricier > 0.25 
				}
				sg:fish = { 
					state_goods_pricier > 0.25 
				}
				sg:fabric = { 
					state_goods_pricier > 0.25 
				}
				sg:meat = { 
					state_goods_pricier > 0.25 
				}
				sg:clothes = { 
					state_goods_pricier > 0.25 
				}
				sg:furniture = { 
					state_goods_pricier > 0.25 
				}
				sg:groceries = { 
					state_goods_pricier > 0.25 
				}
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_scope_state = {
					sg:grain = { 
						state_goods_pricier > 0.25 
					}
				}
			}
			random_scope_state = {
				limit = {
					sg:grain = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:grain = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:fish = { 
						state_goods_pricier > 0.25
					}
				}		
			}
			random_scope_state = {
				limit = {
					sg:fish = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:fish = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:fabric = { 
						state_goods_pricier > 0.25
					}
				}	
			}
			random_scope_state = {
				limit = {
					sg:fabric = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:fabric = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:meat = { 
						state_goods_pricier > 0.25
					}
				}		
			}
			random_scope_state = {
				limit = {
					sg:meat = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:meat = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:clothes = { 
						state_goods_pricier > 0.25
					}
				}	
			}
			random_scope_state = {
				limit = {
					sg:clothes = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:clothes = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:furniture = { 
						state_goods_pricier > 0.25
					}
				}		
			}
			random_scope_state = {
				limit = {
					sg:furniture = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:furniture = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		else_if = {
			limit = {
				any_scope_state = {
					sg:groceries = { 
						state_goods_pricier > 0.25
					}
				}	
			}
			random_scope_state = {
				limit = {
					sg:groceries = { 
						state_goods_pricier > 0.25 
					}
				}
				sg:groceries = { save_scope_as = tut_consumer_good_expensive }
			}				
		}
		add_journal_entry = {
			type = je_tutorial_improve_consumer_goods_access
			objective_subgoal = sg_improve_consumer_goods_access
			target = scope:tut_consumer_good_expensive
		}
	}
}

# Make Interest Group Happy
sg_make_interest_group_happy = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_promote_ig
	}

	trigger = {
		any_interest_group = {
			ig_approval < 2 
			is_marginal = no
		}
	}
	
	on_start = {
		random_interest_group = {
			limit = {
				ig_approval < 2
				is_marginal = no
			}
			save_scope_as = tut_unhappy_ig
		}

		add_journal_entry = {
			type = je_tutorial_make_interest_group_happy
			objective_subgoal = sg_make_interest_group_happy
			target = scope:tut_unhappy_ig
		}
	}
}

sg_enact_institution_law = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_promote_ig
	}

	trigger = {
		or = {
			and = {
				has_law = law_type:law_no_home_affairs
			}
			and = {
				has_law = law_type:law_no_health_system
			}
			and = {
				has_law = law_type:law_no_police
			}
			and = {
				has_law = law_type:law_no_social_security
			}
			and = {
			    NOT = { has_law = law_type:law_serfdom }
			    has_law = law_type:law_no_schools
			}
			and = {
				has_law = law_type:law_no_colonial_affairs
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
			    NOT = { has_law = law_type:law_serfdom }
			    has_law = law_type:law_no_schools
			}
			law_type:law_no_schools = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_police
			}
			law_type:law_no_police = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_health_system
			}
			law_type:law_no_health_system = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_home_affairs
			}
			law_type:law_no_home_affairs = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_social_security
			}
			law_type:law_no_social_security = {
				save_scope_as = tut_institution_lawtype
			}
		}

		else_if = {
			limit = {
				has_law = law_type:law_no_colonial_affairs
			}
			law_type:law_no_colonial_affairs = {
				save_scope_as = tut_institution_lawtype
			}
		}

		add_journal_entry = {
			type = je_tutorial_enact_institution_law
			objective_subgoal = sg_enact_institution_law
			target = scope:tut_institution_lawtype
		}
	}
}

# Reform Government
sg_reform_government = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_promote_ig
	}

	trigger = {
		government_legitimacy <= 40
	}
	
	on_start = {		
		add_journal_entry = {
			type = je_tutorial_reform_government
			objective_subgoal = sg_reform_government
		}
	}
}

# Increase Relations
sg_increase_relations = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_enact_institution_law
		sg_reform_government
	}

	trigger = {
		OR = {
			any_country = {
				capital.region = {
					any_scope_interest_marker = {
						owner = root
					}
				}
				NOT = { this = ROOT }
				country_rank >= rank_value:major_power
				relations:root < relations_threshold:amicable
			}
			any_country = {
				has_attitude = {
					who = ROOT
					attitude >= cautious
				}
				country_rank >= rank_value:major_power
				relations:root < relations_threshold:amicable
			}
			any_country = {
				country_rank >= rank_value:major_power
				relations:root < relations_threshold:amicable
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_country = {
					capital.region = {
						any_scope_interest_marker = {
							owner = root
						}
					}
					NOT = { this = ROOT }
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
			}
			random_country = {
				limit = {
					capital.region = {
						any_scope_interest_marker = {
							owner = root
						}
					}
					NOT = { this = ROOT }
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
				save_scope_as = tut_increase_relations
			}
		}

		else_if = {
			limit = {
				any_country = {
					has_attitude = { 
						who = ROOT
						attitude >= cautious
					}
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
			}
			random_country = {
				limit = {
					has_attitude = { 
						who = ROOT
						attitude >= cautious
					}
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
				save_scope_as = tut_increase_relations
			}
		}

		else_if = {
			limit = {
				any_country = {
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
			}
			random_country = {
				limit = {
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
				}
				save_scope_as = tut_increase_relations
			}
		}
		
		add_journal_entry = {
			type = je_tutorial_increase_relations
			objective_subgoal = sg_increase_relations
			target = scope:tut_increase_relations
		}
	}
}

# Improve Rank
sg_improve_rank = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_make_peace
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_improve_rank
			objective_subgoal = sg_improve_rank
		}
	}
}

# Prevent a Revolution
sg_prevent_revolution = { #currently code bug displays trigger wrong
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_make_interest_group_happy
	}

	trigger = {
		any_civil_war = {
			civil_war_progress >= 0.15
			is_civil_war_type = revolution
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_prevent_revolution
			objective_subgoal = sg_prevent_revolution
		}
	}
}

# Earn Obligation
sg_earn_obligation = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_increase_relations
	}

	trigger = {
		NOT = {
			any_country = { 
				owes_obligation_to = root
			}
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_earn_obligation
			objective_subgoal = sg_earn_obligation
			target = scope:tut_earn_obligation
		}
	}
}

# Expand Military
sg_expand_military = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_create_formation
	}

	trigger = {	
		any_military_formation = {
			is_army = yes
			owner = ROOT
		}
	}
	
	on_start = {
		random_military_formation = {
			limit = {
				is_army = yes
				owner = ROOT
			}
			save_scope_as = tut_expand_army
		}

		add_journal_entry = {
			type = je_tutorial_expand_military
			objective_subgoal = sg_expand_military
			target = scope:tut_expand_army
		}
	}
}

# Increase Command Limit
sg_recruit_promote_commander = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_expand_military
	}

	trigger = {	
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_recruit_promote_commander
			objective_subgoal = sg_recruit_promote_commander
			target = scope:tut_command_commander
		}
	}
}

# Mobilize Army
sg_mobilize_army = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_start_diplomatic_play
	}

	trigger = {
		any_military_formation = {
			is_army = yes
			is_mobilized = no
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_mobilize_army
			objective_subgoal = sg_mobilize_army
		}
	}
}

# Send General to Front
sg_send_general_to_front = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_mobilize_army
	}

	trigger = {
		any_military_formation = {
			is_army = yes
			is_mobilized = yes
			is_on_front = no
		}
	}
	
	on_start = {
		random_military_formation = {
			limit = {
				is_army = yes
				is_mobilized = yes
				is_on_front = no
			}
			save_scope_as = tut_send_general_to_front
		}

		add_journal_entry = {
			type = je_tutorial_send_general_to_front
			objective_subgoal = sg_send_general_to_front
			target = scope:tut_send_general_to_front
		}
	}
}

# Convoy Raiding
sg_convoy_raiding = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_recruit_promote_commander
	}

	trigger = {
		any_scope_character = {
			has_role = general
			NOT = { has_commander_order = defend }
		}
	}
	
	on_start = {
		random_scope_character = { 
			limit = {
				has_role = general
				NOT = { has_commander_order = defend }
			}
			save_scope_as = tut_convoy_raiding
		}
		
		add_journal_entry = {
			type = je_tutorial_convoy_raiding
			objective_subgoal = sg_convoy_raiding
			target = scope:tut_convoy_raiding
		}
	}
}

# Recover From Default
sg_recover_from_default = {
	category = sgcat_tutorial
	
	is_repeatable = yes
	
	unlocking_subgoals_any = {
	}

	trigger = {
		in_default = yes
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_recover_from_default
			objective_subgoal = sg_recover_from_default
		}
	}
}

# Start Diplomatic Play
sg_start_diplomatic_play = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_recruit_promote_commander
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_start_diplomatic_play
			objective_subgoal = sg_start_diplomatic_play
		}
	}
}

# Is Target in Diplomatic Play
sg_is_play_target = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_declare_an_interest
	}

	trigger = {
		is_diplomatic_play_target = yes
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_is_play_target
			objective_subgoal = sg_is_play_target
		}
	}
}

# Fix Capacity Deficit
sg_capacity_deficit = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
	}

	trigger = {
		OR = {
			bureaucracy < -10
			authority < -10
			influence < -10
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_capacity_deficit
			objective_subgoal = sg_capacity_deficit
		}
	}
}

sg_invest_into_an_institution = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_enact_institution_law
	}
	
	trigger = {
		OR = {
			institution:institution_schools = {
				investment < investment_max
			}
			institution:institution_health_system = {
				investment < investment_max
			}
			institution:institution_police = {
				investment < investment_max
			}
			institution:institution_social_security = {
				investment < investment_max
			}
			institution:institution_workplace_safety = {
				investment < investment_max
			}
			institution:institution_home_affairs = {
				investment < investment_max
			}
			institution:institution_colonial_affairs = {
				investment < investment_max
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				institution:institution_schools = {
					investment < investment_max
				}
			}
			institution:institution_schools = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_health_system = {
					investment < investment_max
				}
			}
			institution:institution_health_system = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_police = {
					investment < investment_max
				}
			}
			institution:institution_police = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_social_security = {
					investment < investment_max
				}
			}
			institution:institution_social_security = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_workplace_safety = {
					investment < investment_max
				}
			}
			institution:institution_workplace_safety = {
				save_scope_as = tut_institution
			}
		}

		else_if = {
			limit = {
				institution:institution_home_affairs = {
					investment < investment_max
				}
			}
			institution:institution_home_affairs = {
				save_scope_as = tut_institution
			}
		}
		
		else_if = {
			limit = {
				institution:institution_colonial_affairs = {
					investment < investment_max
				}
			}
			institution:institution_colonial_affairs = {
				save_scope_as = tut_institution
			}
		}
		
		add_journal_entry = {
			type = je_tutorial_invest_into_an_institution
			objective_subgoal = sg_invest_into_an_institution
			target = scope:tut_institution
		}
	}
}

# Incorporate State
sg_incorporate_state = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_invest_into_an_institution
	}

	trigger = {
		any_scope_state = {
			is_incorporated = no
			is_under_colonization = no
		}
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_incorporate_state
			objective_subgoal = sg_incorporate_state
		}
	}
}

# Colonize Region
sg_colonize_state = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_declare_an_interest
	}

	on_start = {
		add_journal_entry = {
			type = je_tutorial_colonize_state
			objective_subgoal = sg_colonize_state
		}
	}
}

# Make Peace
sg_make_peace = {
	category = sgcat_tutorial
	
	unlocking_subgoals_all = {
		sg_send_general_to_front
	}

	trigger = {
		is_at_war = yes
	}

	on_start = {
		add_journal_entry = {
			type = je_tutorial_make_peace
			objective_subgoal = sg_make_peace
		}
	}
}

# Research Technology
sg_research_technology = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
	}

	trigger = {
		NOT = { is_researching_technology = any }
		has_researchable_technology = yes
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_research_technology
			objective_subgoal = sg_research_technology
		}
	}
}

# Declare an Interest
sg_declare_an_interest = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_increase_relations
	}

	on_start = {
		if = {
			limit = {
				any_rival_country = {
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
			}
			random_rival_country = {
				limit = {
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
				save_scope_as = tut_declare_interest_country
			}
		}

		else_if = {
			limit = {
				any_country = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
			}
			random_country = {
				limit = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					country_rank >= rank_value:major_power
					relations:root < relations_threshold:amicable
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
				save_scope_as = tut_declare_interest_country
			}
		}

		else_if = {
			limit = {
				any_country = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					relations:root < relations_threshold:amicable
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
			}
			random_country = {
				limit = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					country_rank >= rank_value:major_power
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
				save_scope_as = tut_declare_interest_country
			}
		}

		else_if = {
			limit = {
				any_country = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
			}
			random_country = {
				limit = {
					NOT = { this = ROOT }
					ROOT = {
						NOT = { has_interest_marker_in_region = prev.capital.region }
					}
					capital.region = {
						can_have_declared_interest_here = ROOT
					}
				}
				save_scope_as = tut_declare_interest_country
			}
		}

		add_journal_entry = {
			type = je_tutorial_declare_an_interest
			objective_subgoal = sg_declare_an_interest
			target = scope:tut_declare_interest_country
		}
	}
}

# Create Formation
sg_create_formation = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_declare_an_interest
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_create_formation
			objective_subgoal = sg_create_formation
		}
		set_variable = {
				name = formation_tutorial_ongoing
		}
	}
}

# Subject Liberty Desire
sg_subject_liberty = {
	category = sgcat_tutorial
	is_repeatable = no

	trigger = {
		any_country = {
			is_subject_of = ROOT
			liberty_desire >= 70
			liberty_desire_weekly_progress > 0
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_country = {
					is_subject_of = ROOT
					liberty_desire >= 70
					liberty_desire_weekly_progress > 0
				}
			}
			random_country = {
				limit = {
					is_subject_of = ROOT
					liberty_desire >= 70
					liberty_desire_weekly_progress > 0
				}
				save_scope_as = tut_subject_liberty_desire
			}
		}

		add_journal_entry = {
			type = je_subject_liberty
			objective_subgoal = sg_subject_liberty
			target = scope:tut_subject_liberty_desire
		}
	}
}

# Foreign Investment
sg_foreign_investment = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_subject_liberty
	}

	trigger = {
		any_country = {
			OR = {
				is_subject_of = ROOT
				has_diplomatic_pact = {
					who = root
					type = foreign_investment_agreement
				}
				root = {
					has_diplomatic_pact = {
						who = prev
						type = foreign_investment_rights
						is_initiator = yes
					}
				}
			}
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_country = {
					OR = {
						is_subject_of = ROOT
						has_diplomatic_pact = {
							who = root
							type = foreign_investment_agreement
						}
						root = {
							has_diplomatic_pact = {
								who = prev
								type = foreign_investment_rights
								is_initiator = yes
							}
						}
					}
				}
			}
			random_country = {
				limit = {
					OR = {
						is_subject_of = ROOT
						has_diplomatic_pact = {
							who = root
							type = foreign_investment_agreement
						}
						root = {
							has_diplomatic_pact = {
								who = prev
								type = foreign_investment_rights
								is_initiator = yes
							}
						}
					}
				}
				save_scope_as = tut_foreign_investment
			}
		}

		add_journal_entry = {
			type = je_tutorial_foreign_investment
			objective_subgoal = sg_foreign_investment
			target = scope:tut_foreign_investment
		}	
	}
}

# Establish Company
sg_establish_company = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expand_productive_building
	}

	trigger = {
		can_establish_company = YES
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_establish_company
			objective_subgoal = sg_establish_company
		}	
	}
}

# Form Power Bloc
sg_form_power_bloc = {
	category = sgcat_tutorial
	is_repeatable = no

	unlocking_subgoals_all = {
	}

	trigger = {
		OR = {
			country_rank = rank_value:great_power
			AND = {
				country_rank = rank_value:major_power
				has_variable = tutorial_form_pb_end
			}
		}
		is_in_power_bloc = no
	}
	
	on_start = {
		add_journal_entry = {
			type = je_tutorial_form_power_bloc
			objective_subgoal = sg_form_power_bloc
		}	
	}
}

# Lobbies
sg_lobbies = {
	category = sgcat_tutorial
	
	unlocking_subgoals_any = {
		sg_increase_relations
	}

	trigger = {
		any_political_lobby = {
			appeasement <= 7
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_political_lobby = {
					OR = {
						is_political_lobby_type = lobby_pro_country
						is_political_lobby_type = lobby_anti_country
					}
				}
			}
			random_political_lobby = {
				limit = {
					OR = {
						is_political_lobby_type = lobby_pro_country
						is_political_lobby_type = lobby_anti_country
					}
				}
				save_scope_as = tut_political_lobby
			}
		}

		add_journal_entry = {
			type = je_tutorial_lobbies
			objective_subgoal = sg_lobbies
			target = scope:tut_political_lobby
		}
	}
}
﻿sg_expand_goods_production = {
	category = sgcat_economic_dominance

	trigger = {
		any_scope_building = {
			is_under_construction = no
			can_queue_building_levels = 1
			is_economic_objective_building = yes
		}
	}
	
	on_start = {
		if = {
			limit = {
				any_scope_building = {
					can_queue_building_levels = 1
					is_building_type = building_iron_mine
				}
			}
			random_scope_building = {
				limit = { 
					can_queue_building_levels = 1
					is_building_type = building_iron_mine
				}
				save_scope_as = economic_building_target
			}				
		}
		
		else_if = {
			limit = {
				any_scope_building = {
					can_queue_building_levels = 1
					is_building_type = building_coal_mine
				}
			}
			random_scope_building = {
				limit = { 
					can_queue_building_levels = 1
					is_building_type = building_coal_mine
				}
				save_scope_as = economic_building_target
			}
		}

		add_journal_entry = {
			type = je_objective_expand_goods_production
			objective_subgoal = sg_expand_goods_production
			target = scope:economic_building_target
		}
	}
}

sg_refining_goods = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expand_goods_production
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_refining_goods
			objective_subgoal = sg_refining_goods
		}	
	}
}

sg_specialized_goods = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_refining_goods
	}

	trigger = { 
	}
	
	on_start = {
		add_journal_entry = {
			type = je_specialized_goods
			objective_subgoal = sg_specialized_goods
		}
	}
}

sg_expanding_the_market = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_specialized_goods
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_expanding_the_market
			objective_subgoal = sg_expanding_the_market
		}
	}
}

sg_strong_market = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_expanding_the_market
		sg_lower_production_costs
	}

	unlocking_subgoals_any = {
		sg_raise_exports_value
		sg_utilizing_our_strength
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_strong_market
			objective_subgoal = sg_strong_market
		}
	}
}

sg_specialized_inputs = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_specialized_goods
	}

	trigger = {
		NOT = { has_variable = player_obj_export_focus }
	}
	
	on_start = {
		add_journal_entry = {
			type = je_specialized_inputs
			objective_subgoal = sg_specialized_inputs
		}
	}
}

sg_utilizing_our_strength = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_specialized_goods
	}

	trigger = {
		has_variable = player_obj_home_focus
	}
	
	on_start = {
		add_journal_entry = {
			type = je_utilizing_our_strength
			objective_subgoal = sg_utilizing_our_strength
		}	
	}
}

sg_exporting_profits = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_specialized_goods
	}

	trigger = {
		NOT = { has_variable = player_obj_home_focus }
	}
	
	on_start = {
		add_journal_entry = {
			type = je_exporting_profits
			objective_subgoal = sg_exporting_profits
		}	
	}
}

sg_raise_exports_value = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_exporting_profits
	}

	trigger = {
		has_variable = player_obj_export_focus
	}
	
	on_start = {
		add_journal_entry = {
			type = je_raise_exports_value
			objective_subgoal = sg_raise_exports_value
		}	
	}
}

sg_lower_production_costs = {
	category = sgcat_economic_dominance
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_refining_goods
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_lower_production_costs
			objective_subgoal = sg_lower_production_costs
		}	
	}
}
﻿sg_encourage_liberal_ideas = {
	category = sgcat_economic_dominance
	is_repeatable = no

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_objective_encourage_liberal_ideas
			objective_subgoal = sg_encourage_liberal_ideas
		}
	}
}

sg_liberate_the_slaves = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	trigger = { 
	}
	
	on_start = {
		add_journal_entry = {
			type = je_liberate_the_slaves
			objective_subgoal = sg_liberate_the_slaves
			target = scope:slavery_objective_target
		}
	}
}

sg_pass_laws = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	unlocking_subgoals_any = {
		sg_encourage_liberal_ideas
		sg_liberate_the_slaves
	}

	trigger = {
	}
	
	on_start = {
		add_journal_entry = {
			type = je_pass_laws
			objective_subgoal = sg_pass_laws
		}	
	}
}

sg_public_services = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_pass_laws
	}

	trigger = {
		NOT = { has_law = law_type:law_state_religion }
		has_law = law_type:law_multicultural
		has_law = law_type:law_public_schools
		has_law = law_type:law_protected_speech
	}
	
	on_start = {
		add_journal_entry = {
			type = je_public_services
			objective_subgoal = sg_public_services
		}	
	}
}

sg_women_and_children = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_public_services
	}

	trigger = {
		NOT = { has_law = law_type:law_state_religion }
		has_law = law_type:law_multicultural
		has_law = law_type:law_public_schools
		has_law = law_type:law_protected_speech
	}
	
	on_start = {
		add_journal_entry = {
			type = je_women_and_children
			objective_subgoal = sg_women_and_children
		}
	}
}

sg_egalitarian_society = {
	category = sgcat_egalitarian_society
	is_repeatable = no

	unlocking_subgoals_all = {
		sg_women_and_children
		sg_liberate_the_slaves 
	}

	trigger = {
		NOT = { has_law = law_type:law_state_religion }
		has_law = law_type:law_multicultural
		has_law = law_type:law_public_schools
		has_law = law_type:law_protected_speech
		has_law = law_type:law_compulsory_primary_school
		has_law = law_type:law_womens_suffrage
	}
	
	on_start = {
		add_journal_entry = {
			type = je_egalitarian_society
			objective_subgoal = sg_egalitarian_society
		}
	}
}

